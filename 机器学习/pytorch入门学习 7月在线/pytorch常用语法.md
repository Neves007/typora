# pytorch常用语法

> #### 初始化：

| 代码                                                         | 含义                                                         |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| torch.empty(5,3)                                             | 返回一个未初始化的5x3张量，元素值是随机的。                  |
| x = torch.rand(5,3)                                          | 返回一个随机初始化的张量； 每个元素在[0, 1) 上均匀分布       |
| x = torch.zeros(5,3,dtype=torch.long)<br>x = torch.zeros(5,3).long() | 返回一个全部为0的张量，类型为long:                           |
| x = torch.tensor([5.5,3])                                    | 从数据直接直接构建张量:                                      |
| x = x.new_ones(5,3, dtype=torch.double)                      | 返回一个全部为0的张量，类型为double:                         |
| x = torch.randn_like(x, dtype=torch.float)                   | 返回与输入大小相同的张量，该张量由均值为0、方差为1的正态分布中的随机数填充 |



>#### 访问：

| 代码        | 含义                                                         |
| ----------- | ------------------------------------------------------------ |
| x.shape     | 返回张量的形状:                                              |
| x[i].item() | 将tensor转换为普通的值。值得注意的是item只能单一值的tensor才能使用item。 |



>#### 修改和计算：

```python
y = torch.rand(5,3)
```

| 代码                                  | 含义                                            |
| ------------------------------------- | ----------------------------------------------- |
| x.view(16)<br>x.view(-1,8)            | 相当于reshape。换一个形状，-1代表这一维自动匹配 |
| x + y<br>torch.add(x, y)<br>y.add_(x) | 两个张量对应相加                                |
| x.mm(y)                               | 两个张量相乘。                                  |
| x.pow(2)                              | 平方                                            |
| x.clamp(min=0,max=1)                  | 把x夹在0到1之间。小于0既是0，大于1既是1。       |
| x.transpose(0,1)                      | 第0维和第1维转置                                |
|                                       |                                                 |





>#### numpy与torch的转化

```
a = torch.ones(5)
```

| 代码                                  | 含义                                            |
| ------------------------------------- | ----------------------------------------------- |
| b = a.numpy() | Torch Tensor  ---->  NumPy ndarray |
|b = torch.from_numpy(a)|Torch Tensor  <----  NumPy ndarray|




>#### CUDA tensors

| 代码                                  | 含义                                            |
| ------------------------------------- | ----------------------------------------------- |
| device = torch.device("cuda") | 定义一个cuda设备 |
| y =torch.ones_like(x, device=device) | 定义一个在cuda的tensor |
| x.to(device) | 把变量移到cuda上计算 |
